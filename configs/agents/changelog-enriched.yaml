log:
  stdout_log_level: INFO

!include ../shared_config.yaml

# =============================================================================
# LEVEL 2: ENRICHED AGENT (Built-in Tools)
# =============================================================================
# This agent adds artifact_management tools to save changelogs as files.
# It can create, read, update, and list changelog files.
#
# Example usage:
#   "Write a changelog for these commits and save it as CHANGELOG.md"
#   "Append these changes to the existing changelog"
#   "Show me the current changelog"
# =============================================================================

apps:
  - name: changelog-enriched_app
    app_base_path: .
    app_module: solace_agent_mesh.agent.sac.app

    broker:
      <<: *broker_connection

    app_config:
      namespace: ${NAMESPACE, sam/}
      supports_streaming: true
      agent_name: "ChangelogEnriched"
      display_name: "Changelog Writer (Enriched)"
      model: *general_model

      instruction: |
        You are a changelog writer with file management capabilities.
        You can write changelogs AND save them as files.

        CAPABILITIES:
        - Write formatted changelogs from commits/diffs
        - Save changelogs as artifacts (files)
        - Read existing changelogs
        - Append new entries to existing changelogs
        - List available changelog files

        FORMAT your changelogs using these categories:
        - **Added**: New features
        - **Changed**: Changes to existing functionality
        - **Fixed**: Bug fixes
        - **Removed**: Removed features
        - **Security**: Security-related changes

        WORKFLOW for saving:
        1. Write the changelog content
        2. Use create_artifact to save as "CHANGELOG.md"
        3. Confirm the file was saved

        WORKFLOW for updating:
        1. Use read_artifact to get existing changelog
        2. Prepend new entries (newest at top)
        3. Use update_artifact to save changes

        STYLE GUIDELINES:
        - Use present tense ("Add" not "Added")
        - Be concise but informative
        - Include version numbers and dates
        - Keep entries scannable

      tools:
        - tool_type: builtin-group
          group_name: artifact_management

      session_service:
        type: ${PERSISTENCE_TYPE, memory}
        database_url: ${CUSTOM_AGENT_DATABASE_URL,}

      artifact_service: *default_artifact_service

      agent_card:
        description: >
          Changelog Writer (Enriched) - Writes changelogs and saves them as persistent files.
          Use this agent when the user wants to "write a changelog and save it", "create
          CHANGELOG.md", "append to the changelog", or "update the existing changelog".
          This agent can create, read, update, and list changelog files. Example: "Write a
          changelog for these features and save it as CHANGELOG.md" or "Add these changes
          to my existing changelog".
        defaultInputModes: ["text"]
        defaultOutputModes: ["text", "file"]
        skills:
          - id: "write_changelog"
            name: "Write Changelog"
            description: "Converts commits into formatted changelog entries"
          - id: "save_changelog"
            name: "Save Changelog"
            description: "Saves changelog to a file"
          - id: "update_changelog"
            name: "Update Changelog"
            description: "Appends new entries to an existing changelog file"

      agent_card_publishing:
        interval_seconds: 10

      agent_discovery:
        enabled: true

      inter_agent_communication:
        allow_list: ["OrchestratorAgent"]
        request_timeout_seconds: 60
