log:
  stdout_log_level: INFO

!include ../shared_config.yaml

# =============================================================================
# LEVEL 3+: GITHUB REMOTE AGENT (PyGithub API)
# =============================================================================
# This agent can query ANY public GitHub repository without cloning.
# Perfect for generating changelogs from external projects.
#
# Example usage:
#   "Generate a changelog for SolaceLabs/solace-agent-mesh from the last 10 commits"
#   "What's new in facebook/react between v18.0.0 and v19.0.0?"
#   "Show me the recent releases of microsoft/vscode"
# =============================================================================

apps:
  - name: changelog-github_app
    app_base_path: .
    app_module: solace_agent_mesh.agent.sac.app

    broker:
      <<: *broker_connection

    app_config:
      namespace: ${NAMESPACE, sam/}
      supports_streaming: true
      agent_name: "ChangelogGitHub"
      display_name: "Changelog Writer (GitHub)"
      model: *general_model

      instruction: |
        You are a changelog writer that can query ANY public GitHub repository.
        You don't need local files - you use the GitHub API directly.

        CAPABILITIES:
        - Get commits from any public GitHub repo (github_get_commits)
        - Get releases and tags (github_get_releases)
        - Compare versions/branches/tags (github_compare_commits)
        - Get repository info (github_get_repo_info)
        - Save changelogs as files (artifact tools)

        IMPORTANT - REPOSITORY FORMAT:
        Always specify repos as "owner/repo-name", for example:
        - "SolaceLabs/solace-agent-mesh"
        - "facebook/react"
        - "microsoft/vscode"

        WORKFLOW for generating changelogs:
        1. Use github_get_repo_info to understand the repository
        2. Use github_get_releases to find version boundaries
        3. Use github_compare_commits to get changes between versions
           OR use github_get_commits for recent activity
        4. Analyze and categorize the changes
        5. Write a formatted changelog
        6. Use create_artifact to save as "CHANGELOG.md"

        FORMAT your changelogs using these categories:
        - **Added**: New features
        - **Changed**: Changes to existing functionality
        - **Fixed**: Bug fixes
        - **Removed**: Removed features
        - **Security**: Security-related changes

        RATE LIMITS:
        Without a GitHub token, you're limited to 60 requests/hour.
        For heavy usage, ask the user to configure GITHUB_TOKEN in tool_config.

      tools:
        # GitHub remote tools (PyGithub)
        - tool_type: python
          component_module: "src.git_tools"
          component_base_path: .
          function_name: "github_get_commits"
          tool_config:
            github_token: ${GITHUB_TOKEN,}

        - tool_type: python
          component_module: "src.git_tools"
          component_base_path: .
          function_name: "github_get_releases"
          tool_config:
            github_token: ${GITHUB_TOKEN,}

        - tool_type: python
          component_module: "src.git_tools"
          component_base_path: .
          function_name: "github_compare_commits"
          tool_config:
            github_token: ${GITHUB_TOKEN,}

        - tool_type: python
          component_module: "src.git_tools"
          component_base_path: .
          function_name: "github_get_repo_info"
          tool_config:
            github_token: ${GITHUB_TOKEN,}

        # Built-in artifact tools
        - tool_type: builtin-group
          group_name: artifact_management

      session_service:
        type: ${PERSISTENCE_TYPE, memory}
        database_url: ${CUSTOM_AGENT_DATABASE_URL,}

      artifact_service: *default_artifact_service

      agent_card:
        description: >
          Changelog Writer (GitHub) - Generates changelogs from any public GitHub repository
          using the GitHub API. Use this agent when the user asks about changes in a GitHub
          repo, wants a changelog from GitHub commits, or asks "what's new in [repo]",
          "generate changelog for [owner/repo]", "compare releases", or "show recent commits".
          Examples: "Generate a changelog for SolaceLabs/solace-agent-mesh from the last 10
          commits", "What's new in facebook/react between v18.0.0 and v19.0.0?", "Show me
          the recent releases of microsoft/vscode".
        defaultInputModes: ["text"]
        defaultOutputModes: ["text", "file"]
        skills:
          - id: "github_changelog"
            name: "GitHub Changelog"
            description: "Generate changelog from any public GitHub repository"
          - id: "compare_releases"
            name: "Compare Releases"
            description: "Show what changed between two GitHub releases"
          - id: "repo_overview"
            name: "Repository Overview"
            description: "Get information about a GitHub repository"

      agent_card_publishing:
        interval_seconds: 10

      agent_discovery:
        enabled: true

      inter_agent_communication:
        allow_list: ["OrchestratorAgent"]
        request_timeout_seconds: 60
